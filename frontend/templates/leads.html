{% extends 'base.html' %}

{% block title %}Leads - Aesthetic LinkWizard{% endblock %}

{% block page_title %}Leads Management{% endblock %}

{% block extra_styles %}
.score-high { background-color: rgba(39, 174, 96, 0.1); color: #27AE60; }
.score-medium { background-color: rgba(243, 156, 18, 0.1); color: #F39C12; }
.score-low { background-color: rgba(231, 76, 60, 0.1); color: #E74C3C; }
.status-new { background-color: rgba(52, 152, 219, 0.1); color: #3498DB; }
.status-contacted { background-color: rgba(155, 89, 182, 0.1); color: #9B59B6; }
.status-replied { background-color: rgba(26, 188, 156, 0.1); color: #1ABC9C; }
.status-archived { background-color: rgba(149, 165, 166, 0.1); color: #95A5A6; }
.persona-match { background-color: rgba(52, 152, 219, 0.1); color: #3498DB; }
{% endblock %}

{% block content %}
<!-- Stats Bar -->
<div class="bg-white rounded-lg shadow p-4 mb-6" id="leads-stats">
    <div class="text-center text-gray-500">Loading statistics...</div>
</div>

<!-- Filters -->
<div class="bg-white rounded-lg shadow p-4 mb-6">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
        <div class="flex flex-wrap gap-2">
            <select id="filter-status" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:border-secondary">
                <option value="all">All Statuses</option>
                <option value="new">New</option>
                <option value="contacted">Contacted</option>
                <option value="replied">Replied</option>
                <option value="archived">Archived</option>
            </select>
            <select id="filter-persona" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:border-secondary">
                <option value="all">All Personas</option>
            </select>
            <input type="number" id="filter-min-score" placeholder="Min Score" min="0" max="100" class="border border-gray-300 rounded-md px-3 py-2 text-sm w-32 focus:outline-none focus:border-secondary">
            <input type="number" id="filter-max-score" placeholder="Max Score" min="0" max="100" class="border border-gray-300 rounded-md px-3 py-2 text-sm w-32 focus:outline-none focus:border-secondary">
        </div>
        <div class="flex space-x-2">
            <button id="apply-filters" class="bg-secondary hover:bg-blue-600 text-white px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="filter" class="w-4 h-4 mr-1"></i> Apply Filters
            </button>
            <button id="reset-filters" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="refresh-cw" class="w-4 h-4 mr-1"></i> Reset
            </button>
        </div>
    </div>
</div>

<!-- Bulk Actions Bar -->
<div class="bg-white rounded-lg shadow p-4 mb-6">
    <div class="flex flex-wrap items-center justify-between gap-3">
        <div>
            <span class="text-sm text-gray-600" id="selected-count">0 leads selected</span>
        </div>
        <div class="flex flex-wrap gap-2">
            <button id="bulk-message" class="bulk-action-btn bg-success hover:bg-green-600 text-white px-4 py-2 rounded-md text-sm flex items-center disabled:opacity-50">
                <i data-feather="message-square" class="w-4 h-4 mr-1"></i> Generate Messages
            </button>
            <button id="bulk-archive" class="bulk-action-btn bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm flex items-center disabled:opacity-50">
                <i data-feather="archive" class="w-4 h-4 mr-1"></i> Archive
            </button>
            <button id="bulk-delete" class="bulk-action-btn bg-danger hover:bg-red-600 text-white px-4 py-2 rounded-md text-sm flex items-center disabled:opacity-50">
                <i data-feather="trash-2" class="w-4 h-4 mr-1"></i> Delete
            </button>
            <button id="bulk-export" class="bg-secondary hover:bg-blue-600 text-white px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="download" class="w-4 h-4 mr-1"></i> Export CSV
            </button>
        </div>
    </div>
</div>

<!-- Leads Table -->
<div class="bg-white rounded-lg shadow overflow-hidden">
    <table id="leadsTable" class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    <input type="checkbox" id="select-all-leads" class="rounded border-gray-300 text-secondary focus:ring-secondary">
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">AI Score</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Persona</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody id="leadsTableBody" class="bg-white divide-y divide-gray-200">
            <tr>
                <td colspan="8" class="px-6 py-8 text-center text-gray-500">
                    <i data-feather="loader" class="w-8 h-8 mx-auto animate-spin mb-2"></i>
                    <p>Loading leads from database...</p>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Lead Stats Summary (hidden, updated by JS) -->
<div id="lead-stats" class="mt-4"></div>
{% endblock %}

{% block extra_js %}
<!-- DataTables -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">

<!-- Leads JS -->
<script src="/static/js/leads.js"></script>

<script>
    // Replace feather icons after page load
    document.addEventListener('DOMContentLoaded', function() {
        feather.replace();
    });
</script>
{% endblock %}
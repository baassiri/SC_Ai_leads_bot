{% extends 'base.html' %}

{% block title %}Messages - Aesthetic LinkWizard{% endblock %}

{% block page_title %}Messages{% endblock %}

{% block extra_styles %}
.message-thread {
    max-height: 500px;
    overflow-y: auto;
}
.message-thread::-webkit-scrollbar {
    width: 6px;
}
.message-thread::-webkit-scrollbar-thumb {
    background-color: #bdc3c7;
    border-radius: 3px;
}
.message-incoming {
    background-color: #f8f9fa;
    border-radius: 0 1rem 1rem 1rem;
}
.message-outgoing {
    background-color: #e3f2fd;
    border-radius: 1rem 0 1rem 1rem;
}
.message-option {
    transition: all 0.2s ease;
}
.message-option:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}
.message-option.selected {
    border: 2px solid #3498DB;
}
{% endblock %}

{% block content %}
<!-- Quick Actions Bar -->
<div class="bg-white rounded-lg shadow p-4 mb-6">
    <div class="flex flex-wrap gap-3 items-center justify-between">
        <div class="flex flex-wrap gap-3">
            <button onclick="loadMessages('draft')" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="edit" class="w-4 h-4 mr-2"></i>
                Draft Messages
            </button>
            <button onclick="loadMessages('approved')" class="bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="check-circle" class="w-4 h-4 mr-2"></i>
                Approved Messages
            </button>
            <button onclick="loadMessages('sent')" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-md text-sm flex items-center">
                <i data-feather="send" class="w-4 h-4 mr-2"></i>
                Sent Messages
            </button>
        </div>
        <div class="flex gap-2">
            <select id="lead-filter" class="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:border-secondary">
                <option value="">All Leads</option>
            </select>
            <button onclick="window.location.reload()" class="bg-gray-100 hover:bg-gray-200 p-2 rounded-md" title="Refresh">
                <i data-feather="refresh-cw" class="w-5 h-5"></i>
            </button>
        </div>
    </div>
</div>

<!-- Messages Container -->
<div id="messages-container" class="space-y-6">
    <div class="bg-white rounded-lg shadow p-8 text-center">
        <i data-feather="loader" class="w-12 h-12 mx-auto animate-spin text-blue-500 mb-4"></i>
        <p class="text-gray-500">Loading messages...</p>
    </div>
</div>

<!-- Message Templates Section -->
<div class="mt-6 bg-white rounded-lg shadow overflow-hidden">
    <div class="p-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-semibold text-gray-800">Message Templates</h2>
        <button class="bg-secondary hover:bg-blue-500 text-white px-3 py-1 rounded-md text-sm flex items-center">
            <i data-feather="plus" class="w-4 h-4 mr-1"></i> New Template
        </button>
    </div>
    <div class="p-4 grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Template 1 -->
        <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer">
            <h3 class="text-sm font-medium text-gray-800 mb-2">Initial Outreach</h3>
            <p class="text-xs text-gray-600 mb-3">Hi [First Name], I came across your profile and noticed your expertise in [Specialty]. Our [Product] offers [Benefit]. Would you be interested in learning more?</p>
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-500">Used 24 times</span>
                <button class="text-xs text-secondary hover:text-blue-500">Use Template</button>
            </div>
        </div>
        
        <!-- Template 2 -->
        <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer">
            <h3 class="text-sm font-medium text-gray-800 mb-2">Follow-Up</h3>
            <p class="text-xs text-gray-600 mb-3">Hi [First Name], I wanted to follow up on my previous message. Have you had a chance to consider [Product] for your practice? I'd be happy to answer any questions.</p>
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-500">Used 18 times</span>
                <button class="text-xs text-secondary hover:text-blue-500">Use Template</button>
            </div>
        </div>
        
        <!-- Template 3 -->
        <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow cursor-pointer">
            <h3 class="text-sm font-medium text-gray-800 mb-2">Clinical Studies</h3>
            <p class="text-xs text-gray-600 mb-3">Hi Dr. [Last Name], you asked about clinical data. Our studies show [Result] compared to [Competitor]. I've attached the full report for your review.</p>
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-500">Used 12 times</span>
                <button class="text-xs text-secondary hover:text-blue-500">Use Template</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/messages.js"></script>
<script>
    // Replace feather icons after page load
    document.addEventListener('DOMContentLoaded', function() {
        feather.replace();
    });
</script>
{% endblock %}